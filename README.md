# Курсовая работа  
**Система персонализированных внутриигровых новостей**  
Spring Boot + PostgreSQL + Redis + Docker

## Описание проекта
Сервис предназначен для формирования и доставки персонализированной новостной ленты игрокам в реальном времени.  
Персонализация основана на тегах новостей и истории взаимодействий пользователя (просмотры, лайки).  
Для ускорения выдачи используется кэширование в Redis, а актуальность кэша поддерживается автоматической инвалидацией при новых взаимодействиях.

## Основные возможности
- Получение персонализированной ленты новостей `/feed/{userId}`
- Регистрация пользовательских взаимодействий (VIEW, CLICK, LIKE) `/interaction/{userId}/{articleId}`
- Администрирование новостей (CRUD) `/admin/articles`
- Кэширование персональных фидов в Redis
- Автоматическая инвалидация кэша при взаимодействии
- Полностью контейнеризированное развертывание (Docker + Docker Compose)

## Используемый технологический стек
| Технология                     | Версия / назначение                                |
|--------------------------------|----------------------------------------------------|
| Java                           | 21                                                 |
| Spring Boot                    | 4.0.0                                              |
| Spring Data JPA + Hibernate    | Персистентность в PostgreSQL                       |
| Spring Data Redis              | Кэширование персональных лент                      |
| Spring Cache                   | Декларативное кэширование                          |
| Spring Web MVC                 | REST API                                           |
| Spring Security (dev-режим)    | Базовая аутентификация (отключена в docker-профиле)|
| PostgreSQL                     | 16-alpine                                          |
| Redis                          | 7-alpine                                           |
| Docker & Docker Compose        | Контейнеризация и оркестрация                      |
| Lombok                         | Уменьшение boilerplate-кода                        |
| Maven                          | Сборка проекта                                     |

## Архитектура
Проект построен по принципам Clean Architecture / Hexagonal Architecture:

```
infrastructure/http          → REST-контроллеры
application/usecase         → Use Cases (интерфейсы бизнес-логики)
application/service         → Реализация ранжирования
domain/model                → Доменные сущности
domain/repository           → Абстракции репозиториев
infrastructure/persistence  → JPA-репозитории и мапперы
config                      → Конфигурация Redis Cache, профили
```

## Структура БД
- `users` – пользователи
- `user_preferences` – предпочтения (теги)
- `news_articles` + `article_tags` – статьи и их теги (ElementCollection)
- `user_activities` – история взаимодействий

## Запуск проекта

### Предварительные требования
- Docker и Docker Compose (последних версий)

### Быстрый старт
```bash
# Клонировать репозиторий
git clone
cd personal-feed-service

# Собрать и запустить все контейнеры
docker compose up --build
```

После запуска сервис доступен по адресу:  
http://localhost:8080

### Основные эндпоинты
| Метод | URL                              | Описание                                      |
|-------|----------------------------------|-----------------------------------------------|
| GET   | `/feed/{userId}?topN=10`         | Персональная лента (кэшируется)               |
| POST  | `/interaction/{userId}/{articleId}?type=LIKE` | Зафиксировать лайк/просмотр (очищает кэш) |
| POST  | `/admin/articles`                | Создать новость (JSON в теле)                 |
| GET   | `/admin/articles/{id}`           | Получить новость                              |
| PUT   | `/admin/articles`                | Обновить новость                              |
| DELETE| `/admin/articles/{id}`           | Удалить новость                               |

### Тестовые данные
При первом запуске автоматически создаются:
- Пользователь `id = 1`
- Предпочтения: теги `tech`, `news`
- Две тестовые новости

Запрос: `http://localhost:8080/feed/1` вернёт новость с тегами `tech`, `news`.

## Особенности реализации
- `@Cacheable(value = "personalized_feed", key = "#userId")` – кэширование по пользователю
- `@CacheEvict(value = "personalized_feed", allEntries = true)` – инвалидация всего кэша при любом взаимодействии
- `RankingService` – взвешенное ранжирование (совпадение тегов × 0.5 + свежесть × 0.3 + популярность × 0.2)
- Все доменные объекты реализуют `Serializable` для корректной работы Redis Cache

## Дальнейшее развитие (по желанию)
1. Автоматическое обновление предпочтений по лайкам
2. JWT-аутентификация вместо передачи `userId` в пути
3. WebSocket-пуш новых новостей
4. OpenAPI (Swagger UI)
5. Unit- и integration-тесты
6. CI/CD (GitHub Actions)
